/**
 @Name：layui.tree 树组件
 @Author：贤心
 @License：MIT
    
 */
layui.define("jquery",function(n){"use strict";var t=layui.$,f=layui.hint(),u="layui-tree-enter",r=function(n){this.options=n},i={arrow:["&#xe623;","&#xe625;"],checkbox:["&#xe626;","&#xe627;"],radio:["&#xe62b;","&#xe62a;"],branch:["&#xe622;","&#xe624;"],leaf:"&#xe621;"};r.prototype.init=function(n){var t=this;n.addClass("layui-box layui-tree");t.options.skin&&n.addClass("layui-tree-skin-"+t.options.skin);t.tree(n);t.on(n)};r.prototype.tree=function(n,r){var f=this,u=f.options,e=r||u.nodes;layui.each(e,function(r,e){var s=e.children&&e.children.length>0,h=t('<ul class="'+(e.spread?"layui-show":"")+'"><\/ul>'),o=t(["<li "+(e.spread?'data-spread="'+e.spread+'"':"")+">",function(){return s?'<i class="layui-icon layui-tree-spread">'+(e.spread?i.arrow[1]:i.arrow[0])+"<\/i>":""}(),function(){return u.check?'<i class="layui-icon layui-tree-check">'+(u.check==="checkbox"?i.checkbox[0]:u.check==="radio"?i.radio[0]:"")+"<\/i>":""}(),function(){return'<a href="'+(e.href||"javascript:;")+'" '+(u.target&&e.href?'target="'+u.target+'"':"")+">"+('<i class="layui-icon layui-tree-'+(s?"branch":"leaf")+'">'+(s?e.spread?i.branch[1]:i.branch[0]:i.leaf)+"<\/i>")+("<cite>"+(e.name||"未命名")+"<\/cite><\/a>")}(),"<\/li>"].join(""));s&&(o.append(h),f.tree(h,e.children));n.append(o);typeof u.click=="function"&&f.click(o,e);f.spread(o,e);u.drag&&f.drag(o,e)})};r.prototype.click=function(n,t){var i=this,r=i.options;n.children("a").on("click",function(n){layui.stope(n);r.click(t)})};r.prototype.spread=function(n){var e=this,o=e.options,t=n.children(".layui-tree-spread"),r=n.children("ul"),u=n.children("a"),f=function(){n.data("spread")?(n.data("spread",null),r.removeClass("layui-show"),t.html(i.arrow[0]),u.find(".layui-icon").html(i.branch[0])):(n.data("spread",!0),r.addClass("layui-show"),t.html(i.arrow[1]),u.find(".layui-icon").html(i.branch[1]))};if(r[0]){t.on("click",f);u.on("dblclick",f)}};r.prototype.on=function(n){var r=this,f=r.options,i="layui-tree-drag";n.find("i").on("selectstart",function(){return!1});if(f.drag)t(document).on("mousemove",function(n){var u=r.move,o,f,e;u.from&&(o=u.to,f=t('<div class="layui-box '+i+'"><\/div>'),n.preventDefault(),t("."+i)[0]||t("body").append(f),e=t("."+i)[0]?t("."+i):f,e.addClass("layui-show").html(u.from.elem.children("a").html()),e.css({left:n.pageX+10,top:n.pageY+10}))}).on("mouseup",function(){var n=r.move;n.from&&(n.from.elem.children("a").removeClass(u),n.to&&n.to.elem.children("a").removeClass(u),r.move={},t("."+i).remove())})};r.prototype.move={};r.prototype.drag=function(n,i){var r=this,o=r.options,f=n.children("a"),e=function(){var e=t(this),f=r.move;f.from&&(f.to={item:i,elem:n},e.addClass(u))};f.on("mousedown",function(){var t=r.move;t.from={item:i,elem:n}});f.on("mouseenter",e).on("mousemove",e).on("mouseleave",function(){var i=t(this),n=r.move;n.from&&(delete n.to,i.removeClass(u))})};n("tree",function(n){var u=new r(n=n||{}),i=t(n.elem);if(!i[0])return f.error("layui.tree 没有找到"+n.elem+"元素");u.init(i)})});